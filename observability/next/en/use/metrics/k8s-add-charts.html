<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Add custom charts to components :: SUSEÂ® Rancher Prime: Observability</title>
    <link rel="prev" href="#dynamic/custom-charts.adoc">
    <link rel="next" href="k8s-writing-promql-for-charts.html">
    <meta name="description" content="SUSE Observability">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../../../_/css/site.css">
<link rel="stylesheet" href="../../../../../_/css/search.css">
<link rel="icon" href="../../../../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="../../../../../_/css/font-styles.css">
<link rel="stylesheet" href="../../../../../_/fonts/css/all.css">
<link rel="stylesheet" href="../../../../../_/css/site-extra.css">
<link rel="stylesheet" href="../../../../../_/css/vendor/tabs.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
href="https://fonts.googleapis.com/css2?family=SUSE:wght@100..800&display=swap" rel="stylesheet">
<link href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" rel="stylesheet">
<!-- <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto&display=swap" rel="stylesheet"> -->
<link rel="stylesheet" href="../../../../../_/css/vendor/light.css">
<!-- <script src="/docserv/res/lightheaded/analytics.js"
        type="text/javascript"></script> -->
    <script>var uiRootPath = '../../../../../_'</script>
  </head>
  <body class="article">
<script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs'; mermaid.initialize({"startOnLoad":true});</script><header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a class=" navbar-logo" href="https://documentation.suse.com/" aria-label="SUSE Documentation Home"><img class="logo"
            src="../../../../../_/img/logo.svg" alt="SUSE logo"/></a>
      </div>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <label class="visual-search-label" for="search-input">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
          <input label="Search" aria-label="Search" id="search-input" type="text" placeholder="Search the docs" >
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">
            <img src="../../../../../_/img/resources.png" class="langIcon Resurces" alt="Resources" title="Resources">
          </div>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://github.com/rancher/stackstate-product-docs"><i class="fab fa-github"></i>&nbsp;Observability</a>
            <div class="has-submenu">
              <a class="navbar-item" href="#" ><i class="fas fa-file-alt"></i>&nbsp;Report Issue &nbsp;<i class="fas fa-chevron-right"></i></a>
              <div class="submenu">
                <a class="navbar-item" href="https://scc.suse.com">SCC (Recommended)</a>
                <a class="navbar-item" href="https://github.com/rancher/stackstate-product-docs/issues">GitHub Issue</a>
              </div>
            </div>
            <a class="navbar-item" href="https://github.com/rancher/product-docs-playbook/blob/main/CONTRIBUTING.md"><i class="fas fa-user-edit"></i>&nbsp;Contribute</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link"><img src="../../../../../_/img/language.png" class="langIcon Language" alt="Language"
              title="Language"></div>
          <div class="navbar-dropdown">
            <!--  </div><div>Icons made by <a href="https://www.flaticon.com/authors/freepik" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div> -->
              <a role="button" class="navbar-item" id="en" onclick="selectLanguage(this.id)">
                <!--<img src="../../../../../_/img/engFlag.svg" class="langIcon english">-->
                &nbsp;English
              </a>
            <!-- LANGUAGESELECTOR -->
          </div>
        </div>
        <!--
        <div class="navbar-item">
          <a href="https://twitter.com/SUSE">
            <img alt="X-logo" class="x-logo" src="../../../../../_/img/x-logo-white.png">
          </a>
        </div>
        -->
      </div>
    </div>

    <!--   <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">

        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
      </div> -->
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="observability" data-version="next">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../../classic.html">Observability</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#README.adoc">SUSE Observability docs!</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../classic.html">Docs for all SUSE Observability products</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../k8s-quick-start-guide.html">Quick start guide</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../k8s-getting-started.html">SUSE Observability walk-through</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../k8s-suse-rancher-prime.html">SUSE Rancher Prime</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../k8s-suse-rancher-prime-air-gapped.html">Air-gapped</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../k8s-suse-rancher-prime-agent-air-gapped.html">Agent Air-gapped</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../troubleshooting/k8s-guided-troubleshooting.html">What is guided troubleshooting?</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../troubleshooting/k8s-configuration.html">YAML Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../troubleshooting/k8s-changes.html">Changes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../troubleshooting/k8s-logs.html">Logs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../alerting/k8s-monitors.html">Monitors</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../alerting/kubernetes-monitors.html">Out of the box monitors for Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../alerting/notifications/README.html">Notifications</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../alerting/notifications/configure.html">Configure notifications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../alerting/notifications/channels/README.html">Notification channels</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../alerting/notifications/channels/slack.html">Slack</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../alerting/notifications/channels/teams.html">Teams</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../alerting/notifications/channels/webhook.html">Webhook</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../alerting/notifications/channels/opsgenie.html">Opsgenie</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../alerting/notifications/troubleshooting.html">Troubleshooting</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="#dynamic/customize-alerting.adoc">Customize</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../alerting/k8s-add-monitors-cli.html">Add a monitor using the CLI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../alerting/k8s-override-monitor-arguments.html">Override monitor arguments</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../alerting/k8s-write-remediation-guide.html">Write a remediation guide</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="k8sTs-explore-metrics.html">Explore Metrics</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="#dynamic/custom-charts.adoc">Custom charts</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="k8s-add-charts.html">Adding custom charts to components</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="k8s-writing-promql-for-charts.html">Writing PromQL queries for representative charts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="k8sTs-metrics-troubleshooting.html">Troubleshooting custom charts</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="#dynamic/advanced-metrics.adoc">Advanced Metrics</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="k8s-stackstate-grafana-datasource.html">Grafana Datasource</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="k8s-prometheus-remote-write.html">Prometheus remote_write</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="open-metrics.html">OpenMetrics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../logs/k8sTs-explore-logs.html">Explore Logs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../logs/k8sTs-log-shipping.html">Log Shipping</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../traces/k8sTs-explore-traces.html">Explore Traces</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../configure/health/health-synchronization.html">Health synchronization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../configure/health/send-health-data/README.html">Send health data over HTTP</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../configure/health/send-health-data/send-health-data.html">Send health data</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../configure/health/send-health-data/repeat_snapshots.html">Repeat Snapshots JSON</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../configure/health/send-health-data/repeat_states.html">Repeat States JSON</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../configure/health/send-health-data/transactional_increments.html">Transactional Increments JSON</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../configure/health/debug-health-sync.html">Debug health synchronization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../views/k8s-views.html">Kubernetes views</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../views/k8s-custom-views.html">Custom views</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../views/k8s-component-views.html">Component views</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../views/k8s-explore-views.html">Explore views</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../views/k8s-view-structure.html">View structure</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../views/k8s-overview-perspective.html">Overview perspective</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../views/k8s-highlights-perspective.html">Highlights perspective</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../views/k8s-topology-perspective.html">Topology perspective</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../views/k8s-events-perspective.html">Events perspective</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../views/k8s-metrics-perspective.html">Metrics perspective</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../views/k8s-traces-perspective.html">Traces perspective</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../views/k8s-filters.html">Filters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../stackstate-ui/k8sTs-keyboard-shortcuts.html">Keyboard shortcuts</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../stackstate-ui/k8sTs-timeline-time-travel.html">Timeline and time travel</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../setup/k8s-network-configuration-saas.html">Network configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/agent/k8s-network-configuration-proxy.html">Proxy Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../k8s-suse-rancher-prime-agent-air-gapped.html">Using a custom registry</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../setup/agent/k8s-custom-secrets-setup.html">Custom Secret Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../setup/agent/k8sTs-agent-request-tracing.html">Request tracing</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/agent/k8sTs-agent-request-tracing-certificates.html">Certificates for sidecar injection</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../setup/otel/getting-started.html">Getting started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../setup/otel/collector.html">Open telemetry collector</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../setup/otel/languages/README.html">Languages</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/otel/languages/sdk-exporter-config.html">Generic Exporter configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/otel/languages/java.html">Java</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/otel/languages/node.js.html">Node.js</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/otel/languages/dot-net.html">.NET</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/otel/languages/verify.html">Verify the results</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../setup/otel/troubleshooting.html">Troubleshooting</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../setup/cli/cli-sts.html">SUSE Observability CLI</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../setup/install-stackstate/README.html">Install SUSE Observability</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/install-stackstate/requirements.html">Requirements</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../setup/install-stackstate/kubernetes_openshift/README.html">Kubernetes / OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../setup/install-stackstate/kubernetes_openshift/kubernetes_install.html">Kubernetes install</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../setup/install-stackstate/kubernetes_openshift/openshift_install.html">OpenShift install</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../setup/install-stackstate/kubernetes_openshift/required_permissions.html">Required Permissions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../setup/install-stackstate/kubernetes_openshift/customize_config.html">Override default configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../setup/install-stackstate/kubernetes_openshift/storage.html">Configure storage</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../setup/install-stackstate/kubernetes_openshift/ingress.html">Exposing SUSE Observability outside of the cluster</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/install-stackstate/initial_run_guide.html">Initial run guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../setup/install-stackstate/troubleshooting.html">Troubleshooting</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../configure/logging/kubernetes-logs.html">Logs</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../setup/configure-stackstate/README.html">Configure SUSE Observability</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/configure-stackstate/slack-notifications.html">Slack notifications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/configure-stackstate/email-notifications.html">E-mail notifications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../stackpacks/about-stackpacks.html">Stackpacks</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../setup/release-notes/README.html">Release Notes</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/release-notes/20240911112250.html">v2.0.0 - 11/09/2024</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/release-notes/20240918082712.html">v2.0.1 - 18/09/2024</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/release-notes/20241001154902.html">v2.0.2 - 01/10/2024</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../setup/upgrade-stackstate/README.html">Upgrade SUSE Observability</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/upgrade-stackstate/steps-to-upgrade.html">Steps to upgrade</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/upgrade-stackstate/version-specific-upgrade-instructions.html">Version-specific upgrade instructions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../setup/install-stackstate/kubernetes_openshift/uninstall.html">Uninstall SUSE Observability</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../setup/install-stackstate/kubernetes_openshift/no_internet/README.html">Air-gapped</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../k8s-suse-rancher-prime-air-gapped.html">SUSE Observability air-gapped</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../k8s-suse-rancher-prime-agent-air-gapped.html">SUSE Observability Kubernetes Agent air-gapped</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../setup/data-management/README.html">Data management</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../setup/data-management/backup_restore/README.html">Backup and Restore</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../setup/data-management/backup_restore/kubernetes_backup.html">Kubernetes backup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../setup/data-management/backup_restore/configuration_backup.html">Configuration backup</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/data-management/data_retention.html">Data retention</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/data-management/clear_stored_data.html">Clear stored data</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../setup/security/README.html">Security</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../setup/security/authentication/README.html">Authentication</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../setup/security/authentication/authentication_options.html">Authentication options</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../setup/security/authentication/file.html">File-based</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../setup/security/authentication/ldap.html">LDAP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../setup/security/authentication/oidc.html">Open ID Connect (OIDC)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../setup/security/authentication/keycloak.html">KeyCloak</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../setup/security/authentication/service_tokens.html">Service tokens</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../setup/security/rbac/README.html">RBAC</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../setup/security/rbac/role_based_access_control.html">Role-based Access Control</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../setup/security/rbac/rbac_permissions.html">Permissions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../setup/security/rbac/rbac_roles.html">Roles</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../setup/security/rbac/rbac_scopes.html">Scopes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../setup/security/self-signed-certificates.html">Self-signed certificates</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../security/k8s-service-tokens.html">Service Tokens</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../security/k8s-ingestion-api-keys.html">Ingestion API Keys</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../saas/user-management.html">User Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../develop/reference/k8sTs-stql_reference.html">SUSE Observability Query Language (STQL)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../develop/reference/k8sTs-chart-units.html">Chart units</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../configure/topology/identifiers.html">Topology Identifiers</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Observability</span>
    <span class="version">Next</span>
  </div>
  <ul class="components">
        <li class="component is-current">
          <div class="title"><a href="../../classic.html">Observability</a></div>
          <ul class="versions">
            <li class="version is-current is-latest">
              <a href="../../classic.html">Next</a>
            </li>
          </ul>
        </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../classic.html" aria-label="Home" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../classic.html">Observability</a></li>
    <li><a href="#dynamic/custom-charts.adoc">Custom charts</a></li>
    <li><a href="k8s-add-charts.html">Adding custom charts to components</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/rancher/stackstate-product-docs/edit/main/docs/next/modules/en/pages/use/metrics/k8s-add-charts.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Add custom charts to components</h1>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>SUSE Observability provides already many metric charts by default on most types of components that represent Kubernetes resources. Extra metric charts can be added to any set of components whenever needed. When adding metrics to components there are 2 options:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The metrics are already collected by SUSE Observability but aren&#8217;t visualized on a component by default</p>
</li>
<li>
<p>The metrics aren&#8217;t yet collected by SUSE Observability at all and therefore aren&#8217;t available yet</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For option 1 the steps below will instruct you how to create a metric binding which will configure SUSE Observability to add a specific metric to a specific set of components.</p>
</div>
<div class="paragraph">
<p>In case of option 2, first make sure that the metrics are available in SUSE Observability, by sending them to SUSE Observability using the <a href="k8s-prometheus-remote-write.html" class="xref page">Prometheus remote write protocol</a>. Only after that continue by adding charts for the metrics to the components.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_steps"><a class="anchor" href="#_steps"></a>Steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Steps to create a metric binding:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#write-the-outline-of-the-metric-binding">Write the outline of the metric binding</a></p>
</li>
<li>
<p><a href="#write-the-topology-query">Write the topology query (STQL) to select the components</a></p>
</li>
<li>
<p><a href="#write-the-promql-query">Write the PromQL query for the desired metric</a></p>
</li>
<li>
<p><a href="#bind-the-correct-time-series-to-each-component">Bind the correct time series to each component</a></p>
</li>
<li>
<p><a href="#create-or-update-the-metric-binding-in-stackstate">Create or update the metric binding in SUSE Observability</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>As an example the steps will add a metric binding for the <code>Replica counts</code>  of Kubernetes deployments. This is just an example, this metric binding already exists in SUSE Observability by default.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_write_the_outline_of_the_metric_binding"><a class="anchor" href="#_write_the_outline_of_the_metric_binding"></a>Write the outline of the metric binding</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Create a new YAML file called <code>metric-bindings.yaml</code> and add this YAML template to it to create your own metric binding. Open it in your favorite code editor to change it throughout this guide. At the end the SUSE Observability CLI will be used to create and update the metric bindings in SUSE Observability.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>nodes:
- _type: MetricBinding
  chartType: line
  enabled: true
  tags: {}
  unit:
  name:
  description:
  priority:
  identifier: urn:custom:metric-binding:...
  queries:
    - expression:
      alias:
  scope:
  layout:
    weight:
    layouts:
      - pespective: Metrics
        tab:
          name:
          weight:
        section:
          name:
          weight:</pre>
</div>
</div>
<div class="paragraph">
<p>The fields in this template are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>_type</code>: SUSE Observability needs to know this is a metric binding so, value always needs to be <code>MetricBinding</code></p>
</li>
<li>
<p><code>chartType</code>: SUSE Observability will support different chart types (<code>line</code>, <code>bar</code>, etc.), currently only <code>line</code> is supported</p>
</li>
<li>
<p><code>enabled</code>: Set to <code>false</code> to keep the metric binding but not show it to users</p>
</li>
<li>
<p><code>tags</code>: Will be used to organize metrics in the user interface, can be left empty using <code>{}</code></p>
</li>
<li>
<p><code>unit</code>: The unit of the values in the time series returned by the query or queries, used to render the Y-axis of the chart. See the <a href="../../develop/reference/k8sTs-chart-units.html" class="xref page">supported units</a> reference for all units.</p>
</li>
<li>
<p><code>name</code>: The name for the metric binding</p>
</li>
<li>
<p><code>description</code>: Optional description, displayed on-hover of the name</p>
</li>
<li>
<p><code>priority</code>: [Deprecated] One of <code>HIGH</code>, <code>MEDIUM</code>, or <code>LOW</code>. Main sort order for metrics on a component (in the order they&#8217;re mentioned here), secondary sort order is the <code>name</code>.</p>
</li>
<li>
<p><code>identifier</code>: A URN (universal resource identifier), used as the unique identifier of the metric binding. It must start with <code>urn:custom:metric-binding:</code>, the remainder is free-format as long as it&#8217;s unique amongst all metric bindings.</p>
</li>
<li>
<p><code>queries</code>: A list of queries to show in the chart for the metric binding (see also the following sections)</p>
</li>
<li>
<p><code>scope</code>: The topology scope of the metric binding, a topology query that selects the components on which this metric binding will be shown.</p>
</li>
<li>
<p><code>layout</code>: How to groups charts on different perspective views, e.g. on <a href="../views/k8s-metrics-perspective.html" class="xref page">Metrics perspective</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Fill in all the parts already known first (with the deployment replica counts as the example)</p>
</div>
<div class="listingblock">
<div class="content">
<pre>_type: MetricBinding
chartType: line
enabled: true
tags: {}
unit: short
name: Replica counts
priority: MEDIUM
identifier: urn:custom:metric-binding:my-deployment-replica-counts
queries:
  - expression:
    alias:
scope:</pre>
</div>
</div>
<div class="paragraph">
<p>The queries and scope section will be filled in the next steps. Note that the unit used is <code>short</code>, which will simply render a numeric value. In case you&#8217;re not sure yet about the unit of the metric, you can leave it open and decide on the correct unit when writing the PromQL query.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_write_the_topology_query"><a class="anchor" href="#_write_the_topology_query"></a>Write the topology query</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use the Explore view of the <a href="../views/k8s-topology-perspective.html" class="xref page">Topology perspective</a>, <a href="http://your-instance/#/views/explore" class="bare">http://your-instance/#/views/explore</a>, and select the components that need to show the new metric. Both the basic and advanced views can be used to make the selection. The most common fields to select topology on for metric bindings are <code>type</code> for the component type and <code>label</code> for selecting all the labels. For example for the deployments:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>type = "deployment" and label = "stackpack:kubernetes"</pre>
</div>
</div>
<div class="paragraph">
<p>The type filter selects all deployments, while the label filter selects only components created by the Kubernetes stackpack (label name is <code>stackpack</code> and label value is <code>kubernetes</code>). The latter can also be omitted to get the same result.</p>
</div>
<div class="paragraph">
<p>Switch to the advanced mode to copy the resulting topology query and put it in the <code>scope</code> field of the metric binding.</p>
</div>
<div class="paragraph">
<p>{% hint syle="info" %}
Metric bindings only support the query filters, query functions like <code>withNeighborsOf</code> aren&#8217;t supported and can&#8217;t be used.
{% endhint %}</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_write_the_promql_query"><a class="anchor" href="#_write_the_promql_query"></a>Write the PromQL query</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Go to the <a href="k8sTs-explore-metrics.html" class="xref page">metric explorer</a> of your SUSE Observability instance, <a href="http://your-instance/#/metrics" class="bare">http://your-instance/#/metrics</a>, and use it to query for the metric of interest. The explorer has auto-completion for metrics, labels, label values but also PromQL functions, and operators to help you out. Start with a short time range of, for example, an hour to get the best results.</p>
</div>
<div class="paragraph">
<p>For the total number of replicas use the <code>kubernetes_state_deployment_replicas</code> metric. To make the charts shown for this metric representative for the time series data extend the query to do an aggregation using the <code>${__interval}</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>max_over_time(kubernetes_state_deployment_replicas[${__interval}])</pre>
</div>
</div>
<div class="paragraph">
<p>In this specific case use <code>max_over_time</code> to make sure the chart always shows the highest number of replicas at any given time. For longer time ranges this means that a short dip in replicas won&#8217;t be shown, to emphasize the lowest number of replicas use <code>min_over_time</code> instead.</p>
</div>
<div class="paragraph">
<p>Copy the query into the <code>expression</code> property of the first entry in the <code>queries</code> field of the metric binding. Use <code>Total replicas</code> as an alias. This is the name that will show in the chart legend.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In SUSE Observability the size of the metric chart automatically determines the granularity of the metric shown in the chart. PromQL queries can adjusted to make optimal use of this behavior to get a representative chart for the metric. <a href="k8s-writing-promql-for-charts.html" class="xref page">Writing PromQL for charts</a> explains this in detail.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bind_the_correct_time_series_to_each_component"><a class="anchor" href="#_bind_the_correct_time_series_to_each_component"></a>Bind the correct time series to each component</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The metric binding with all fields filled in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>_type: MetricBinding
chartType: line
enabled: true
tags: {}
unit: short
name: Replica counts
priority: MEDIUM
identifier: urn:custom:metric-binding:my-deployment-replica-counts
queries:
  - expression: max_over_time(kubernetes_state_deployment_replicas[${__interval}])
    alias: Total replicas
scope: type = "deployment" and label = "stackpack:kubernetes"</pre>
</div>
</div>
<div class="paragraph">
<p>Creating it in SUSE Observability and viewing the "Replica count" chart on a deployment component gives an unexpected result. The chart shows the replica counts for all deployments. Logically one would expect only 1 time series: the replica count for this specific deployment.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/k8s/k8s-replica-counts-without-binding.png" alt="The incorrect chart for a single deployment" width="it shows the replica count for all deployments">
</div>
</div>
<div class="paragraph">
<p>To fix this make the PromQL query specific for a component using information from the component. Filter on enough metric labels to select only the specific time series for the component. This is the "binding" of the correct time series to the component. For anyone experienced in making Grafana dashboards this is similar to a dashboard with parameters that are used in queries on the dashboard. Let&#8217;s change the query in the metric binding to this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>max_over_time(kubernetes_state_deployment_replicas{cluster_name="${tags.cluster-name}", namespace="${tags.namespace}", deployment="${name}"}[${__interval}])</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/k8s/k8s-replica-counts-with-binding.png" alt="After adding the parameterized filters the resulting chart looks as expected" width="only 1 time series for this component">
</div>
</div>
<div class="paragraph">
<p>The PromQL query now filters on 3 labels, <code>cluster_name</code>, <code>namespace</code> and <code>deployment</code>. Instead of specifying an actual value for these labels a variable reference to fields of the component is used. In this case the labels <code>cluster-name</code> and <code>namespace</code> are used, referenced using <code>${tags.cluster-name}</code> and <code>${tags.namespace}</code>. Further the component name is referenced with <code>${name}</code>.</p>
</div>
<div class="paragraph">
<p>Supported variable references are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Any component label, using <code>${tags.&lt;label-name&gt;}</code></p>
</li>
<li>
<p>The component name, using <code>${name}</code></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/k8s/k8s-carts-highlights.png" alt="Component Highlights page that shows the labels and component name (both highlighted in red)">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The cluster name, namespace and a combination of the component type and name are ususally enough for selecting the metrics for a specific component from Kubernetes. These labels, or similar labels, are usually available on most metrics and components.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_or_update_the_metric_binding_in_suse_observability"><a class="anchor" href="#_create_or_update_the_metric_binding_in_suse_observability"></a>Create or update the metric binding in SUSE Observability</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use the SUSE Observability CLI to create the metric binding in SUSE Observability. Make sure the <code>metric-bindings.yaml</code> is saved and looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>nodes:
- _type: MetricBinding
  chartType: line
  enabled: true
  tags: {}
  unit: short
  name: Replica counts
  priority: MEDIUM
  identifier: urn:custom:metric-binding:my-deployment-replica-counts
  queries:
    - expression: max_over_time(kubernetes_state_deployment_replicas{cluster_name="${tags.cluster-name}", namespace="${tags.namespace}", deployment="${name}"}[${__interval}])
      alias: Total replicas
  scope: type = "deployment" and label = "stackpack:kubernetes"</pre>
</div>
</div>
<div class="paragraph">
<p>Use the <a href="../../setup/cli/cli-sts.html" class="xref page">SUSE Observability CLI</a> to create the metric binding:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sts settings apply -f metric-bindings.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify the results in SUSE Observability by opening the metrics perspective for a deployment. If you&#8217;re not happy with the result simply change the metric binding in the YAML file and run the command again to update it. The list of nodes supports adding many metric bindings. Simply add another metric binding entry to the YAML array using the same steps as before.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The identifier is used as the unique key of a metric binding. Changing the identifier will create a new metric binding instead of updating the existing one.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>sts settings</code> command has more options, for example it can list all metric bindings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sts settings list --type MetricBinding</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally to delete a metric binding use</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sts settings delete --ids &lt;id&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>&lt;id&gt;</code> in this command isn&#8217;t the identifier but the number in the <code>Id</code> column of the <code>sts settings list</code> output.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The recommended way of working is to store metric bindings (and any other custom resources created in SUSE Observability) as YAML files in a Git repository. From there changes can be manually applied or it can be fully automated by using the SUSE Observability CLI in a CI/CD system like GitHub actions or GitLab pipelines.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_other_options"><a class="anchor" href="#_other_options"></a>Other options</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_more_than_1_time_series_in_a_chart"><a class="anchor" href="#_more_than_1_time_series_in_a_chart"></a>More than 1 time series in a chart</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There is only 1 unit for a metric binding (it gets plotted on the y-axis of the chart). As a result you should only combine queries that produce time series with the same unit in 1 metric binding. Sometimes it might be possible to convert the unit. For example, CPU usage might be reported in milli-cores or cores, milli-cores can be converted to cores by multiplying by 1000 like this  <code>(&lt;original-query&gt;) * 1000</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are 2 ways to get more than 1 time series in a single metric binding and therefore in a single chart:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Write a PromQL query that returns multiple time series for a single component</p>
</li>
<li>
<p>Add more PromQL queries to the metric binding</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For the first option an example is given in the <a href="./k8s-add-charts.adoc#using-metric-labels-in-aliases">next section</a>. The second option can be useful for comparing related metrics. Some typical use-cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Comparing total replicas vs desired and available</p>
</li>
<li>
<p>Resource usage: limits, requests and usage in a single chart</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To add more queries to a metric binding simply repeat <a href="./k8s-add-charts.adoc#steps">steps</a> 3. and 4. and add the query as an extra entry in the list of queries. For the deployment replica counts there are several related metrics that can be included in the same chart:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>nodes:
- _type: MetricBinding
  chartType: line
  enabled: true
  tags: {}
  unit: short
  name: Replica counts
  priority: MEDIUM
  identifier: urn:custom:metric-binding:my-deployment-replica-counts
  queries:
    - expression: max_over_time(kubernetes_state_deployment_replicas{cluster_name="${tags.cluster-name}", namespace="${tags.namespace}", deployment="${name}"}[${__interval}])
      alias: Total replicas
    - expression: max_over_time(kubernetes_state_deployment_replicas_available{cluster_name="${tags.cluster-name}", namespace="${tags.namespace}",  deployment="${name}"}[${__interval}])
      alias: Available - ${cluster_name} - ${namespace} - ${deployment}
    - expression: max_over_time(kubernetes_state_deployment_replicas_unavailable{cluster_name="${tags.cluster-name}", namespace="${tags.namespace}",  deployment="${name}"}[${__interval}])
      alias: Unavailable - ${cluster_name} - ${namespace} - ${deployment}
    - expression: min_over_time(kubernetes_state_deployment_replicas_desired{cluster_name="${tags.cluster-name}", namespace="${tags.namespace}",  deployment="${name}"}[${__interval}])
      alias: Desired - ${cluster_name} - ${namespace} - ${deployment}
  scope: type = "deployment" and label = "stackpack:kubernetes"</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/k8s/k8s-replica-counts-multiple-timeseries.png" alt="Metric binding with multiple metrics">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_metric_labels_in_aliases"><a class="anchor" href="#_using_metric_labels_in_aliases"></a>Using metric labels in aliases</h3>
<div class="paragraph">
<p>When a single query returns multiple time series per component, this will show as multiple lines in the chart. But in the legend they will all use the same alias. To be able to see the difference between the different time series the alias can include references to the metric labels using the <code>${label}</code> syntax. For example here is a metric binding for the "Container restarts" metric on a pod, note that a pod can have multiple containers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>type: MetricBinding
chartType: line
enabled: true
id: -1
identifier: urn:custom:metric-binding:my-pod-restart-count
name: Container restarts
priority: MEDIUM
queries:
- alias: Restarts - ${container}
  expression: max by (cluster_name, namespace, pod_name, container) (kubernetes_state_container_restarts{cluster_name="${tags.cluster-name}", namespace="${tags.namespace}", pod_name="${name}"})
scope: (label = "stackpack:kubernetes" and type = "pod")
unit: short</pre>
</div>
</div>
<div class="paragraph">
<p>Note that the <code>alias</code> references the <code>container</code> label of the metric. Make sure the label is present on the query result, when the label is missing the <code>${container}</code> will be rendered as literal text to help troubleshooting.</p>
</div>
</div>
<div class="sect2">
<h3 id="_layouts"><a class="anchor" href="#_layouts"></a>Layouts</h3>
<div class="paragraph">
<p>Each component can be associated with various technologies or protocols such as k8s, networking, runtime environments (e.g., JVM), protocols (HTTP, AMQP), etc.
Consequently, a multitude of different metrics can be displayed for each component. For easier readability, SUSE Observability can organize these charts into tabs and sections.
To display a chart (<code>MetricBinding</code>) within a specific tab or section, you need to configure the layout property.
Any MetricsBinding without a specified layout will be displayed in a tab and section named <code>Other</code>.</p>
</div>
<div class="paragraph">
<p>Here is an example configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>layout:
  weight: 100
  layouts:
    - perspective: Metrics
      tab:
        name: AMQP
        weight: 150
      section:
        name: Performance
        weight: 300</pre>
</div>
</div>
<div class="paragraph">
<p>Fields:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>layout.weight</code> - This represents the weight of the chart within sections. The charts are sorted in ascending order by weight, followed by alphabetical order.</p>
</li>
<li>
<p><code>layout.layouts</code> -  (array) This allows each chart to be added to multiple views (perspectives).</p>
</li>
<li>
<p><code>layout.layouts.perspective</code> - This is the type of perspective to display the chart. Currently, only the <code>Metrics</code> perspective is supported.</p>
<div class="ulist">
<ul>
<li>
<p><code>Metrics</code> - display on <a href="../views/k8s-metrics-perspective.html" class="xref page">Metrics perspective</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>layout.layouts.tab</code> - This indicates the tab <code>name</code> and its <code>weight</code>. Tabs are sorted ascending by weight (the lowest one from all <code>MetricBinding</code>), followed by alphabetical order.</p>
</li>
<li>
<p><code>layout.layouts.section</code> - This is the section <code>name</code> and its <code>weight</code>. Sections are sorted alphabetically.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="#dynamic/custom-charts.adoc">Custom charts</a></span>
  <span class="next"><a href="k8s-writing-promql-for-charts.html">Writing PromQL queries for representative charts</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script src="../../../../../_/js/site.js"></script>
<script async src="../../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../../.." data-snippet-length="100" data-stylesheet="../../../../../_/css/search.css"></script>
<script async src="../../../../../search-index.js"></script>
<script src="../../../../../_/js/vendor/langSelection.js"></script>
<script async src="../../../../../_/js/vendor/tabs.js"></script>


  </body>
</html>
